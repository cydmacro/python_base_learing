# 📊 评分表格Excel公式设置指南

> 将CSV模板导入Excel后的公式设置完整指南  
> 适用于：Microsoft Excel 2016+、WPS表格、Google Sheets

---

## 🎯 目录

1. [快速开始](#快速开始)
2. [每日测评打分表公式](#每日测评打分表公式)
3. [学员总成绩统计表公式](#学员总成绩统计表公式)
4. [学员成绩单公式](#学员成绩单公式)
5. [常见问题](#常见问题)

---

## 🚀 快速开始

### Step 1: 导入CSV模板到Excel

**方法1: 直接打开（推荐）**
```
1. 用Excel直接打开CSV文件
2. 选择"数据" → "导入数据" → "自CSV"
3. 选择编码：UTF-8
4. 点击"完成"
```

**方法2: 导入向导**
```
1. Excel新建空白工作簿
2. 数据 → 获取数据 → 来自文件 → 从文本/CSV
3. 选择CSV文件
4. 编码选UTF-8，分隔符选逗号
5. 加载数据
```

### Step 2: 设置表格格式

**设置数据区域为表格**：
1. 选中数据区域（包括标题行）
2. 按 `Ctrl + T` 或 点击"插入" → "表格"
3. 勾选"表包含标题"
4. 点击"确定"

**好处**：
- 公式自动应用到新行
- 筛选功能自动启用
- 引用更清晰（使用表列名）

### Step 3: 设置公式

按照下面的章节逐个设置公式。

---

## 📋 每日测评打分表公式

### 表格结构

| 列号 | 列名 | 说明 | 数据类型 |
|------|------|------|---------|
| A | 学号 | 001-030 | 文本 |
| B | 姓名 | 学员姓名 | 文本 |
| C-L | 题1-题10 | 填"正确"或"错误" | 文本 |
| M | 理论分 | **公式列** | 数字 |
| N | 实操题1 | 手动输入0-5 | 数字 |
| O | 实操题2 | 手动输入0-5 | 数字 |
| P | 实操分 | **公式列** | 数字 |
| Q | 总分 | **公式列** | 数字 |
| R | 备注 | 手动填写 | 文本 |

---

### 公式设置详解

#### 1️⃣ M列：理论分（自动统计正确题数）

**位置**：M2单元格

**公式**：
```excel
=COUNTIF(C2:L2,"正确")
```

**说明**：
- 统计C2到L2区域内值为"正确"的单元格数量
- 自动计算得分（满分10分）

**设置步骤**：
1. 点击M2单元格
2. 输入公式：`=COUNTIF(C2:L2,"正确")`
3. 按Enter确认
4. 拖动M2右下角的填充柄向下填充到M31

**验证**：
- 张三（第2行）10题全对，M2应显示 `10`
- 李四（第3行）错1题，M3应显示 `9`

---

#### 2️⃣ P列：实操分（两题相加）

**位置**：P2单元格

**公式**：
```excel
=N2+O2
```

**说明**：
- 实操题1分数 + 实操题2分数
- 满分10分（5+5）

**设置步骤**：
1. 点击P2单元格
2. 输入公式：`=N2+O2`
3. 按Enter确认
4. 向下填充到P31

**验证**：
- 张三实操题1得5分，实操题2得5分
- P2应显示 `10`

---

#### 3️⃣ Q列：总分（理论+实操）

**位置**：Q2单元格

**公式**：
```excel
=M2+P2
```

**说明**：
- 理论分 + 实操分
- 满分20分

**设置步骤**：
1. 点击Q2单元格
2. 输入公式：`=M2+P2`
3. 按Enter确认
4. 向下填充到Q31

**验证**：
- 张三理论10分，实操10分
- Q2应显示 `20`（满分）

---

### 统计数据公式

在表格底部的统计区域设置以下公式：

#### 📊 总人数

**位置**：假设在B34单元格

**公式**：
```excel
=COUNTA(B2:B31)
```

**说明**：统计B2:B31区域非空单元格数量

---

#### 📊 班级平均分

**位置**：假设在M34单元格

**公式**：
```excel
=AVERAGE(Q2:Q31)
```

**说明**：计算Q列（总分）的平均值

---

#### 📊 及格人数（≥12分）

**位置**：假设在B35单元格

**公式**：
```excel
=COUNTIF(Q2:Q31,">=12")
```

**说明**：统计总分≥12分的人数

---

#### 📊 及格率

**位置**：假设在C35单元格

**公式**：
```excel
=COUNTIF(Q2:Q31,">=12")/COUNTA(B2:B31)
```

**说明**：及格人数 ÷ 总人数

**格式设置**：
- 右键单元格 → 设置单元格格式
- 选择"百分比"，保留2位小数
- 示例：0.85 显示为 85.00%

---

#### 📊 优秀人数（≥18分）

**位置**：假设在B36单元格

**公式**：
```excel
=COUNTIF(Q2:Q31,">=18")
```

**说明**：统计总分≥18分的人数

---

#### 📊 优秀率

**位置**：假设在C36单元格

**公式**：
```excel
=COUNTIF(Q2:Q31,">=18")/COUNTA(B2:B31)
```

**说明**：优秀人数 ÷ 总人数

---

#### 📊 最高分

**位置**：假设在M35单元格

**公式**：
```excel
=MAX(Q2:Q31)
```

---

#### 📊 最低分

**位置**：假设在M36单元格

**公式**：
```excel
=MIN(Q2:Q31)
```

---

### 条件格式设置（可选）

让成绩自动变色，一眼看出优秀/及格/不及格。

#### 设置总分列（Q列）条件格式

**Step 1: 选中Q2:Q31**

**Step 2: 开始 → 条件格式 → 新建规则**

**规则1: 优秀（≥18分）绿色**
- 选择"只为包含以下内容的单元格设置格式"
- 单元格值 ≥ 18
- 格式：填充绿色，字体加粗
- 确定

**规则2: 及格（12-17分）黄色**
- 单元格值 ≥ 12
- 单元格值 < 18
- 格式：填充黄色
- 确定

**规则3: 不及格（<12分）红色**
- 单元格值 < 12
- 格式：填充红色，字体白色
- 确定

---

## 📊 学员总成绩统计表公式

### 表格结构

| 列号 | 列名 | 说明 | 类型 |
|------|------|------|------|
| A | 学号 | 001-030 | 文本 |
| B | 姓名 | 学员姓名 | 文本 |
| C-L | Day1-Day10 | **手动输入**（从每日表复制） | 数字 |
| M | 测评总分 | **公式** | 数字 |
| N | 测评得分(60) | **公式** | 数字 |
| O-Q | 项目1/2/3 | **手动输入**0-10 | 数字 |
| R | 项目总分(30) | **公式** | 数字 |
| S | 出勤(4) | **手动输入**0-4 | 数字 |
| T | 互动(3) | **手动输入**0-3 | 数字 |
| U | 作业(3) | **手动输入**0-3 | 数字 |
| V | 课堂表现(10) | **公式** | 数字 |
| W | 总成绩(100) | **公式** | 数字 |
| X | 等级 | **公式** | 文本 |
| Y | 班级排名 | **公式** | 数字 |
| Z-AB | 证书/推荐 | **手动或公式** | 文本 |

---

### 公式设置详解

#### 1️⃣ M列：测评总分（Day1-10相加）

**位置**：M2单元格

**公式**：
```excel
=SUM(C2:L2)
```

**说明**：
- 将Day1到Day10的成绩相加
- 满分200分（10天×20分）

**设置步骤**：
1. 点击M2
2. 输入 `=SUM(C2:L2)`
3. Enter确认
4. 向下填充到M31

---

#### 2️⃣ N列：测评得分（折算为60分）

**位置**：N2单元格

**公式**：
```excel
=M2*0.3
```

**说明**：
- 测评总分（200分制）× 0.3 = 60分制
- 200 × 0.3 = 60

**设置步骤**：
1. 点击N2
2. 输入 `=M2*0.3`
3. Enter确认
4. 向下填充到N31

**验证**：
- 张三测评总分180.5，N2应显示 `54.15`

---

#### 3️⃣ R列：项目总分（项目1+2+3）

**位置**：R2单元格

**公式**：
```excel
=SUM(O2:Q2)
```

**说明**：
- 项目1 + 项目2 + 项目3
- 满分30分

**设置步骤**：
1. 点击R2
2. 输入 `=SUM(O2:Q2)`
3. Enter确认
4. 向下填充到R31

---

#### 4️⃣ V列：课堂表现（出勤+互动+作业）

**位置**：V2单元格

**公式**：
```excel
=SUM(S2:U2)
```

**说明**：
- 出勤 + 互动 + 作业
- 满分10分

**设置步骤**：
1. 点击V2
2. 输入 `=SUM(S2:U2)`
3. Enter确认
4. 向下填充到V31

---

#### 5️⃣ W列：总成绩（100分制）

**位置**：W2单元格

**公式**：
```excel
=N2+R2+V2
```

**说明**：
- 测评得分(60) + 项目总分(30) + 课堂表现(10)
- 满分100分

**设置步骤**：
1. 点击W2
2. 输入 `=N2+R2+V2`
3. Enter确认
4. 向下填充到W31

**验证**：
- 张三：54.15 + 28 + 9.5 = `91.65`

---

#### 6️⃣ X列：等级（优秀/良好/及格/不及格）

**位置**：X2单元格

**公式**：
```excel
=IF(W2>=90,"优秀",IF(W2>=80,"良好",IF(W2>=60,"及格","不及格")))
```

**说明**：
- ≥90分：优秀
- 80-89分：良好
- 60-79分：及格
- <60分：不及格

**设置步骤**：
1. 点击X2
2. 输入上述公式
3. Enter确认
4. 向下填充到X31

**嵌套IF逻辑**：
```
IF(总分>=90,
    "优秀",
    IF(总分>=80,
        "良好",
        IF(总分>=60,
            "及格",
            "不及格"
        )
    )
)
```

---

#### 7️⃣ Y列：班级排名

**位置**：Y2单元格

**公式**：
```excel
=RANK(W2,$W$2:$W$31,0)
```

**说明**：
- RANK函数：计算排名
- W2：当前学员的总分
- $W$2:$W$31：全班总分范围（**绝对引用**）
- 0：降序排列（分数越高排名越前）

**设置步骤**：
1. 点击Y2
2. 输入 `=RANK(W2,$W$2:$W$31,0)`
3. Enter确认
4. 向下填充到Y31

**注意**：
- 必须使用 `$` 符号锁定范围 `$W$2:$W$31`
- 否则下拉时范围会变化，导致排名错误

**验证**：
- 吴十（99.1分）排名应为 `1`
- 李四（97.7分）排名应为 `2`

---

#### 8️⃣ Z列：证书类型（基于等级）

**位置**：Z2单元格

**公式**：
```excel
=IF(X2="优秀","优秀结业证书",IF(X2="良好","良好结业证书",IF(X2="及格","合格结业证书","")))
```

**说明**：
- 优秀 → 优秀结业证书
- 良好 → 良好结业证书
- 及格 → 合格结业证书
- 不及格 → 空白

---

#### 9️⃣ AA列：推荐等级（基于等级）

**位置**：AA2单元格

**公式**：
```excel
=IF(X2="优秀","优先推荐",IF(X2="良好","推荐就业",IF(X2="及格","建议进修","不推荐")))
```

---

### 统计数据公式

在表格底部添加以下统计：

#### 📊 总人数
```excel
=COUNTA(B2:B31)
```

#### 📊 班级平均分
```excel
=AVERAGE(W2:W31)
```

#### 📊 最高分
```excel
=MAX(W2:W31)
```

#### 📊 最低分
```excel
=MIN(W2:W31)
```

#### 📊 优秀人数（≥90）
```excel
=COUNTIF(W2:W31,">=90")
```

#### 📊 优秀率
```excel
=COUNTIF(W2:W31,">=90")/COUNTA(B2:B31)
```
格式设置为百分比

#### 📊 良好人数（80-89）
```excel
=COUNTIF(W2:W31,">=80")-COUNTIF(W2:W31,">=90")
```

#### 📊 良好率
```excel
=(COUNTIF(W2:W31,">=80")-COUNTIF(W2:W31,">=90"))/COUNTA(B2:B31)
```

#### 📊 及格人数（60-79）
```excel
=COUNTIF(W2:W31,">=60")-COUNTIF(W2:W31,">=80")
```

#### 📊 及格率
```excel
=COUNTIF(W2:W31,">=60")/COUNTA(B2:B31)
```

#### 📊 不及格人数（<60）
```excel
=COUNTIF(W2:W31,"<60")
```

#### 📊 淘汰率
```excel
=COUNTIF(W2:W31,"<60")/COUNTA(B2:B31)
```

#### 📊 成绩分布统计

**90-100分**：
```excel
=COUNTIFS(W2:W31,">=90",W2:W31,"<=100")
```

**80-89分**：
```excel
=COUNTIFS(W2:W31,">=80",W2:W31,"<90")
```

**70-79分**：
```excel
=COUNTIFS(W2:W31,">=70",W2:W31,"<80")
```

**60-69分**：
```excel
=COUNTIFS(W2:W31,">=60",W2:W31,"<70")
```

**0-59分**：
```excel
=COUNTIF(W2:W31,"<60")
```

---

### 条件格式设置

#### 总成绩列（W列）变色

选中W2:W31，设置条件格式：

**优秀（≥90）**：绿色填充，深绿字体，加粗  
**良好（80-89）**：浅蓝填充，深蓝字体  
**及格（60-79）**：黄色填充，深黄字体  
**不及格（<60）**：红色填充，白色字体，加粗  

#### 等级列（X列）图标集

选中X2:X31，条件格式 → 图标集：
- 优秀 → 绿色勾
- 良好 → 黄色感叹号
- 及格 → 橙色箭头
- 不及格 → 红色叉

---

## 📄 学员成绩单公式

### 表格结构

| 列 | 列名 | 说明 | 类型 |
|----|------|------|------|
| A | 学号 | 从统计表复制 | 文本 |
| B | 姓名 | 从统计表复制 | 文本 |
| C | 总成绩 | **公式或复制** | 数字 |
| D | 等级 | **公式或复制** | 文本 |
| E | 班级排名 | **公式或复制** | 文本 |
| F | 每日测评 | **公式** | 文本 |
| G | 项目作品 | **公式** | 文本 |
| H | 课堂表现 | **公式** | 文本 |
| I | 证书类型 | 从统计表复制 | 文本 |
| J | 推荐等级 | 从统计表复制 | 文本 |
| K | 讲师评语 | **手动填写** | 文本 |

---

### 公式设置详解

#### 方法1: 从统计表引用（推荐）

假设统计表在Sheet1，成绩单在Sheet2：

**C2单元格（总成绩）**：
```excel
=Sheet1!W2
```

**D2单元格（等级）**：
```excel
=Sheet1!X2
```

**E2单元格（排名）**：
```excel
=Sheet1!Y2&"/"&COUNTA(Sheet1!$B$2:$B$31)
```
显示为："3/30"

---

#### 方法2: 使用VLOOKUP查找

如果统计表和成绩单学号顺序不同，使用VLOOKUP：

**C2单元格（总成绩）**：
```excel
=VLOOKUP(A2,Sheet1!$A$2:$AB$31,23,0)
```

**说明**：
- A2：当前学号
- Sheet1!$A$2:$AB$31：统计表数据范围
- 23：总成绩在第23列（W列）
- 0：精确匹配

---

#### F列：每日测评（显示为"54.15/60"）

**F2单元格**：
```excel
=TEXT(Sheet1!N2,"0.00")&"/"&"60"
```

或者更简洁：
```excel
=Sheet1!N2&"/60"
```

---

#### G列：项目作品（显示为"28/30"）

**G2单元格**：
```excel
=Sheet1!R2&"/30"
```

---

#### H列：课堂表现（显示为"9.5/10"）

**H2单元格**：
```excel
=Sheet1!V2&"/10"
```

---

### 打印设置

**设置打印区域**：
1. 选中A1:K31
2. 页面布局 → 打印区域 → 设置打印区域

**调整页面**：
1. 页面布局 → 方向 → 横向
2. 缩放至一页宽

**页眉页脚**：
1. 插入 → 页眉和页脚
2. 页眉：Python AI极速训练营 · 学员成绩单
3. 页脚：第X页/共X页

---

## ❓ 常见问题

### Q1: 公式显示为文本，不计算结果？

**原因**：单元格格式为"文本"

**解决**：
1. 选中公式单元格
2. 右键 → 设置单元格格式
3. 选择"常规"或"数字"
4. 按F2编辑公式，再按Enter

---

### Q2: 下拉填充公式后，范围跟着变化？

**原因**：没有使用绝对引用（$符号）

**解决**：
- 相对引用：`A1` → 下拉会变成A2, A3...
- 绝对引用：`$A$1` → 下拉不变
- 混合引用：`$A1`（列固定）、`A$1`（行固定）

**示例**：
```excel
# 错误：
=RANK(W2,W2:W31,0)  ❌ 下拉后范围会变

# 正确：
=RANK(W2,$W$2:$W$31,0)  ✅ 范围锁定
```

---

### Q3: COUNTIF统计不准确？

**检查点**：
1. **区域是否正确**：`C2:L2`（10个单元格）
2. **条件是否加引号**：`"正确"` 不是 `正确`
3. **中英文符号**：`"正确"` 不是 `"正确"`（全角引号）
4. **空格问题**：`"正确"` 不是 `" 正确 "`

**调试技巧**：
```excel
# 先测试单个单元格
=C2="正确"  # 返回TRUE或FALSE

# 再测试COUNTIF
=COUNTIF(C2:L2,"正确")
```

---

### Q4: 及格率显示为小数，如何转为百分比？

**方法1: 设置单元格格式**
1. 选中单元格
2. 右键 → 设置单元格格式
3. 选择"百分比"
4. 小数位数：2

**方法2: 公式内乘100**
```excel
=COUNTIF(Q2:Q31,">=12")/COUNTA(B2:B31)*100&"%"
```

**方法3: 使用TEXT函数**
```excel
=TEXT(COUNTIF(Q2:Q31,">=12")/COUNTA(B2:B31),"0.00%")
```

---

### Q5: 如何快速填充公式到所有行？

**方法1: 双击填充柄**
1. 选中公式单元格（如M2）
2. 将鼠标移到单元格右下角（出现黑色十字）
3. **双击**左键
4. 公式自动填充到数据末尾

**前提**：左侧列（如姓名列）必须有连续数据

**方法2: 拖动填充**
1. 选中公式单元格
2. 按住右下角填充柄向下拖动

**方法3: 快捷键填充**
1. 选中M2:M31区域
2. 按 `Ctrl + D`（向下填充）

---

### Q6: 如何防止公式被误删？

**方法1: 保护工作表**
1. 选中所有数据输入单元格（如姓名、分数）
2. 右键 → 设置单元格格式 → 保护
3. 取消勾选"锁定"
4. 审阅 → 保护工作表
5. 设置密码
6. 确定

**现在**：
- 数据输入单元格可编辑
- 公式单元格被保护，无法修改

**方法2: 隐藏公式**
1. 选中公式列
2. 右键 → 设置单元格格式 → 保护
3. 勾选"隐藏"
4. 保护工作表

**现在**：
- 选中单元格时，编辑栏不显示公式
- 防止学员看到公式

---

### Q7: 如何批量复制Day1-10成绩到统计表？

**方法1: 逐个复制粘贴**
```
1. 打开"Day01测评打分表.xlsx"
2. 复制Q2:Q31（总分列）
3. 打开"学员总成绩统计表.xlsx"
4. 选择性粘贴 → 数值 → 到C列（Day1）
5. 重复Day2-Day10
```

**方法2: 使用公式引用（更智能）**

在统计表的C2单元格输入：
```excel
='[Day01测评打分表.xlsx]Sheet1'!$Q2
```

**说明**：
- `[文件名.xlsx]` → 引用其他文件
- `Sheet1` → 工作表名
- `$Q2` → 单元格地址

**缺点**：
- 需要打开所有Day文件
- 文件移动会导致引用失效

**推荐**：Day1-10评分完成后，复制粘贴为数值

---

### Q8: 如何制作动态图表？

**成绩分布饼图**：

**Step 1: 准备数据**
```
| 等级   | 人数 |
|--------|------|
| 优秀   | =COUNTIF($X$2:$X$31,"优秀") |
| 良好   | =COUNTIF($X$2:$X$31,"良好") |
| 及格   | =COUNTIF($X$2:$X$31,"及格") |
| 不及格 | =COUNTIF($X$2:$X$31,"不及格") |
```

**Step 2: 插入图表**
1. 选中数据区域
2. 插入 → 饼图 → 三维饼图
3. 图表标题："班级成绩分布"

**Step 3: 美化图表**
1. 添加数据标签（显示百分比）
2. 设置颜色：
   - 优秀：绿色
   - 良好：蓝色
   - 及格：黄色
   - 不及格：红色

---

## 🎨 美化建议

### 标题行美化

1. **字体**：微软雅黑，14号，加粗
2. **背景色**：深蓝色 (#4472C4)
3. **字体颜色**：白色
4. **对齐**：居中
5. **边框**：所有边框，白色

### 数据行美化

1. **字体**：微软雅黑，11号
2. **隔行变色**：
   - 奇数行：白色
   - 偶数行：浅灰色 (#F2F2F2)
3. **边框**：浅灰色边框

### 统计区域美化

1. **背景色**：浅黄色 (#FFF2CC)
2. **字体**：加粗
3. **边框**：深色边框

---

## ✅ 检查清单

**完成公式设置后，逐项检查**：

**每日测评表**：
- [ ] M列理论分公式正确（COUNTIF）
- [ ] P列实操分公式正确（N+O）
- [ ] Q列总分公式正确（M+P）
- [ ] 统计数据公式完整（及格率、优秀率）
- [ ] 条件格式设置完成

**总成绩统计表**：
- [ ] M列测评总分公式正确（SUM）
- [ ] N列测评得分公式正确（×0.3）
- [ ] R列项目总分公式正确
- [ ] V列课堂表现公式正确
- [ ] W列总成绩公式正确
- [ ] X列等级公式正确（IF嵌套）
- [ ] Y列排名公式正确（RANK，绝对引用）
- [ ] Z/AA列证书和推荐公式正确
- [ ] 所有统计数据公式完整

**学员成绩单**：
- [ ] 引用公式正确（VLOOKUP或直接引用）
- [ ] 成绩显示格式正确（"54.15/60"）
- [ ] 打印格式设置完成

**其他**：
- [ ] 工作表保护设置
- [ ] 备份文件已保存
- [ ] 公式已测试验证

---

## 📌 提示

### 公式优先级

Excel公式计算顺序：
1. `()` 括号
2. `^` 幂运算
3. `*` `/` 乘除
4. `+` `-` 加减
5. `&` 连接符
6. `=` `<` `>` 比较运算

### 常用函数速查

| 函数 | 功能 | 示例 |
|------|------|------|
| `SUM` | 求和 | `=SUM(A1:A10)` |
| `AVERAGE` | 平均值 | `=AVERAGE(A1:A10)` |
| `COUNT` | 计数（数字） | `=COUNT(A1:A10)` |
| `COUNTA` | 计数（非空） | `=COUNTA(A1:A10)` |
| `COUNTIF` | 条件计数 | `=COUNTIF(A1:A10,">=60")` |
| `COUNTIFS` | 多条件计数 | `=COUNTIFS(A1:A10,">=60",A1:A10,"<80")` |
| `IF` | 条件判断 | `=IF(A1>=60,"及格","不及格")` |
| `MAX` | 最大值 | `=MAX(A1:A10)` |
| `MIN` | 最小值 | `=MIN(A1:A10)` |
| `RANK` | 排名 | `=RANK(A1,$A$1:$A$10,0)` |
| `VLOOKUP` | 垂直查找 | `=VLOOKUP(A1,表,2,0)` |
| `TEXT` | 格式化文本 | `=TEXT(A1,"0.00%")` |

---

**文档版本**: v1.0  
**最后更新**: 2025年  
**作者**: AI讲师

**需要帮助？** 参考"学员评分体系说明.md"或联系技术支持。

---

🎉 **恭喜！评分表格设置完成！**

现在你已经拥有了一套完整的自动化评分系统：
- ✅ 每日测评自动统计
- ✅ 总成绩自动计算
- ✅ 等级自动评定
- ✅ 排名自动生成
- ✅ 证书推荐自动匹配

**下一步**：开始使用表格进行评分，专注于教学质量！
